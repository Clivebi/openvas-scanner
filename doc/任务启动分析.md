被ospd_openvas调用的时候，通过如下参数启动
-c 配置文件 --scan-start (taskID)任务ID

openvas通过搜索所有的redis里面的数据库，看哪里可以找到
internal/taskID/scanprefs这个key，找到之后使用这个数据库
找到之后，读取这个key下面的所有值，这个值得构成如下：
content|||other other的内容目前没用到
content的内容如下
name:value:type --name 为配置项的名字 value为值 type 为file的时候，value 是文件内容
开启任务后
设置redis 的internal/taskID 下的ready 并且internal/ovas_pid设置为当前进程PID
停止的时候，就可以读出这个PID，然后杀掉进程
几个重要参数：
test_alive_hosts_only 只扫描探测到的目标，这个标志会导致先判断主机是否存活
TARGET  扫描目标,使用逗号","分隔
port_range 端口范围,使用逗号","分隔 #80,137,587,3128,8081 T:80,137,587,3128,8081,U:53
plugin_set 脚本的oid列表，使用分号";"分隔
auto_enable_dependencies 是否自动加载依赖脚本

加载所有脚本信息之后，使用脚本类型进行分组，按分组顺序执行
脚本类型即脚本中script_category指定的值
执行顺序
  ACT_INIT = 0,
  ACT_SCANNER,
  ACT_SETTINGS,
  ACT_GATHER_INFO,
  ACT_ATTACK,
  ACT_MIXED_ATTACK,
  ACT_DESTRUCTIVE_ATTACK,
  ACT_DENIAL,
  ACT_KILL_HOST,
  ACT_FLOOD,
  ACT_END,

internal/status 报告进度
值类型 hostname/当前进度/最大值


任务完成后
internal/results为扫描结果,其中包括,
%s|||%s|||%s|||%s|||%s |||%s
类型 IP host 端口/协议 oid 消息


internal/taskID 设置为finish


报告数据有两个位置
internal/results
%s|||%s|||%s|||%s|||%s |||%s
类型 IP host 端口/协议 oid 消息
消息的构成类似http header  如下：
key:值 \n 如果key比较长 值前有\n
HostDetails下
# HostDetails                     => "OS"
# HostDetails/NVT                 => "1.2.3.4.5.6"
# --
# HostDetails/NVT/1.2.3.4.5.6     => "NVT Description"
# HostDetails/NVT/1.2.3.4.5.6/OS  => "Debian"
# --
# HostDetails                     => "OS"
# HostDetails/NVT                 => "1.2.3.4"
# --
# HostDetails/NVT/1.2.3.4         => "another NVT description"
# HostDetails/NVT/1.2.3.4/OS      => "cpe:/o:debian_linux:debian:5.0"